# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at

#   http://www.apache.org/licenses/LICENSE-2.0

# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.

##########
# Tests for reading and writing parquet files with bloom filters
##########

# enable bloom filters
statement ok
set datafusion.execution.parquet.bloom_filter_enabled = true;

# create a single parquet file
# Write row groups with 5 rows each
statement error DataFusion error: SQL error: ParserError\("Expected \), found: ,"\)
COPY  (
  SELECT
    column1 as x,
    column2 as y
  FROM ( VALUES
    (1, 1),
    (2, 1),
    (3, 2),
    (4, 2),
    (5, 3),
    -- row group boundary
    (6, 3),
    (7, 4),
    (8, 4),
    (9, 5),
    (10, 5)
  )
 )
 TO 'test_files/scratch/parquet_bloom/t.parquet'
(FORMAT PARQUET, SINGLE_FILE_OUTPUT true, BLOOM_FILTER_ENABLED true, MAX_ROW_GROUP_SIZE 5);

statement ok
CREATE EXTERNAL TABLE t (
  x int,
  y int
)
STORED AS PARQUET
LOCATION 'test_files/scratch/parquet_bloom/t.parquet';

query II
select * from t;
----
1 1
2 1
3 2
4 2
5 3
6 3
7 4
8 4
9 5
10 5
